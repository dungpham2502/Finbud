{"ast":null,"code":"import { resolveComponent as _resolveComponent, createVNode as _createVNode, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, createBlock as _createBlock, withCtx as _withCtx, createElementVNode as _createElementVNode, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\";\nconst _withScopeId = n => (_pushScopeId(\"data-v-96f3dc52\"), n = n(), _popScopeId(), n);\nconst _hoisted_1 = {\n  class: \"home-container\"\n};\nconst _hoisted_2 = {\n  class: \"chat-container\"\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  const _component_SideBar = _resolveComponent(\"SideBar\");\n  const _component_ChatHeader = _resolveComponent(\"ChatHeader\");\n  const _component_MessageComponent = _resolveComponent(\"MessageComponent\");\n  const _component_ChatFrame = _resolveComponent(\"ChatFrame\");\n  const _component_UserInput = _resolveComponent(\"UserInput\");\n  return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [_createVNode(_component_SideBar, {\n    threads: $data.threads,\n    onAddThread: $options.addThread,\n    onEditThread: $options.editThread,\n    onSaveThreadName: $options.saveThreadName,\n    onCancelEdit: $options.cancelEdit,\n    onSelectThread: $options.selectThread\n  }, null, 8 /* PROPS */, [\"threads\", \"onAddThread\", \"onEditThread\", \"onSaveThreadName\", \"onCancelEdit\", \"onSelectThread\"]), _createElementVNode(\"div\", _hoisted_2, [_createVNode(_component_ChatHeader, {\n    threadId: $data.currentThread.id\n  }, null, 8 /* PROPS */, [\"threadId\"]), _createVNode(_component_ChatFrame, null, {\n    default: _withCtx(() => [(_openBlock(true), _createElementBlock(_Fragment, null, _renderList($data.messages, (message, index) => {\n      return _openBlock(), _createBlock(_component_MessageComponent, {\n        key: index,\n        \"is-user\": message.isUser,\n        text: message.text,\n        typing: message.typing,\n        timestamp: message.timestamp,\n        username: message.isUser ? 'Tri Bui' : 'FinBud Bot',\n        \"avatar-src\": message.isUser ? $data.userAvatar : $data.botAvatar\n      }, null, 8 /* PROPS */, [\"is-user\", \"text\", \"typing\", \"timestamp\", \"username\", \"avatar-src\"]);\n    }), 128 /* KEYED_FRAGMENT */))]),\n    _: 1 /* STABLE */\n  }), _createVNode(_component_UserInput, {\n    onSendMessage: $options.sendMessage,\n    onClearMessage: $options.clearMessage\n  }, null, 8 /* PROPS */, [\"onSendMessage\", \"onClearMessage\"])])]);\n}","map":{"version":3,"names":["class","_createElementBlock","_hoisted_1","_createVNode","_component_SideBar","threads","$data","onAddThread","$options","addThread","onEditThread","editThread","onSaveThreadName","saveThreadName","onCancelEdit","cancelEdit","onSelectThread","selectThread","_createElementVNode","_hoisted_2","_component_ChatHeader","threadId","currentThread","id","_component_ChatFrame","default","_withCtx","_Fragment","_renderList","messages","message","index","_createBlock","_component_MessageComponent","key","isUser","text","typing","timestamp","username","userAvatar","botAvatar","_","_component_UserInput","onSendMessage","sendMessage","onClearMessage","clearMessage"],"sources":["/Users/buidinhtri/Desktop/FindBud/FinBud-AI-bot/src/views/ChatView.vue"],"sourcesContent":["<template>\n  <div class=\"home-container\">\n    <SideBar\n      :threads=\"threads\"\n      @add-thread=\"addThread\"\n      @edit-thread=\"editThread\"\n      @save-thread-name=\"saveThreadName\"\n      @cancel-edit=\"cancelEdit\"\n      @select-thread=\"selectThread\"\n    />\n    <div class=\"chat-container\">\n      <ChatHeader :threadId=\"currentThread.id\" />\n      <ChatFrame>\n        <MessageComponent\n          v-for=\"(message, index) in messages\"\n          :key=\"index\"\n          :is-user=\"message.isUser\"\n          :text=\"message.text\"\n          :typing=\"message.typing\"\n          :timestamp=\"message.timestamp\"\n          :username=\"message.isUser ? 'Tri Bui' : 'FinBud Bot'\"\n          :avatar-src=\"message.isUser ? userAvatar : botAvatar\"\n        />\n      </ChatFrame>\n      <UserInput @send-message=\"sendMessage\" @clear-message=\"clearMessage\" />\n    </div>\n  </div>\n</template>\n\n<script>\nimport ChatHeader from '../components/ChatHeader.vue';\nimport ChatFrame from '../components/ChatFrame.vue';\nimport MessageComponent from '../components/MessageComponent.vue';\nimport UserInput from '../components/UserInput.vue';\nimport { fetchStockPrice } from '@/services/stockServices';\nimport { gptAPICall } from '@/services/gptServices';\nimport SideBar from '../components/SideBar.vue';\n\nexport default {\n  name: 'ChatView',\n  props: ['threadId'],\n  components: {\n    ChatHeader,\n    ChatFrame,\n    MessageComponent,\n    UserInput,\n    SideBar\n  },\n  data() {\n    return {\n      newMessage: '',\n      messages: [],\n      userAvatar: require('@/assets/tri.jpeg'),\n      botAvatar: require('@/assets/bot.png'),\n      currentThread: {},\n      threads: []\n    };\n  },\n  watch: {\n    threadId: {\n      immediate: true,\n      handler(newThreadId) {\n        console.log('Received new thread ID:', newThreadId);\n        if (newThreadId != null) {\n          this.updateCurrentThread(newThreadId);\n        }\n      }\n    },\n  },\n  methods: {\n    clearMessage() {\n      this.newMessage = ''\n    },\n    updateCurrentThread(newThreadId) {\n      console.log(\"Update current thread function triggered: \", newThreadId)\n      const thread = this.threads.find(thread => thread.id.toString() === newThreadId);\n      console.log(thread)\n      if (thread) {\n        this.currentThread = thread;\n        this.messages = thread.messages || [];\n      } else {\n        console.error('Thread with ID', newThreadId, 'not found');\n        this.currentThread = {};\n        this.messages = [];\n      }\n      console.log(\"Current thread: \", this.currentThread)\n    },\n    addThread(newThread) {\n      newThread.id = this.threads.length + 1;\n      this.threads.push(newThread);\n      console.log(\"Added new thread: \", newThread);\n    },\n    editThread(index) {\n      this.threads[index].editing = true;\n    },\n    saveThreadName({ newName, index }) {\n      this.threads[index].name = newName;\n      this.threads[index].editing = false;\n    },\n    cancelEdit(index) {\n      this.threads[index].editing = false;\n    },\n    selectThread(index) {\n      this.updateCurrentThread(this.threads[index].id.toString());\n    },\n    async sendMessage(newMessage) {\n      console.log(\"start sending message in send message..\")\n\n      this.messages.push({\n        text: newMessage.trim(),\n        isUser: true,\n        typing: true,\n        timestamp: new Date().toLocaleTimeString()\n      });\n\n      this.newMessage = '';\n\n      const stockCode = this.extractStockCode(this.messages[this.messages.length - 1].text);\n      if (stockCode.length > 0) {\n        try {\n          const price = await fetchStockPrice(stockCode);\n          const timeStamp = new Date().toLocaleTimeString();\n          let responseText = `Giá cổ phiếu ${stockCode} hiện giờ là $${price}, tính theo mốc thời gian ${timeStamp} `;\n          this.addTypingResponse(responseText, false);\n          const analysisQuestion = `Phân tích các số liệu sau từ công ty Tesla Chỉ Số Nâng CaoTên\tCông ty\tNgành\n      Tỉ số P/E TTM\t39.31\t18.18\n  Giá trên doanh thu TTM\t5.66\t3.93\n  Giá và dòng tiền mặt MRQ\t64.94\t16.68\n  Giá và dòng tiền mặt tự do TTM\t388.36\t33.6\n  Giá trên giá ghi sổ sách MRQ\t8.34\t2.67\n  Giá trên sổ sách hữu hình MRQ\t8.39\t0.64\n  Khả năng sinh lợi: TTM đối với Biên Lợi Trung Bình 5 Năm TTM (%)  TB 5 năm (%)\n  Lãi gộp\n  Lãi gộp kinh doanh\n  Tỷ lệ lời trước thuế\n  Hệ số biên lợi nhuận ròng\n  0%\n  5%\n  10%\n  15%\n  20%\n  25%\n  Hệ số biên lợi nhuận ròng\n       TTM (%)\t14.37%\n       TB 5 năm (%)\t7.59%\n  Lãi gộp TTM\t17.78%\t17.76\n  Lãi Gộp 5YA\t21.49%\t14.78\n  Lãi gộp kinh doanh TTM\t7.81%\t-8.16\n  Lãi gộp kinh doanh 5YA\t8.96%\t-2,221.2\n  Tỷ lệ lời trước thuế TTM\t9.21%\t-11.27\n  Tỷ lệ lời trước thuế 5YA\t7.96%\t-2,230.78\n  Hệ số biên lợi nhuận ròng TTM\t14.37%\t-11.97\n  Hệ số biên lợi nhuận ròng 5YA\t7.59%\t-2,209.64\n  Doanh thu/Cổ phần TTM\t29.75\t11,209.08\n  EPS cơ bản ANN\t4.73\t637.24\n  EPS pha loãng ANN\t4.3\t637.15\n  Giá trị sổ sách/Cổ phần MRQ\t20.21\t6,320.76\n  Giá trị sổ sách hữu hình/Cổ phần MRQ\t20.06\t6,055.95\n  Tiền mặt/Cổ phần MRQ\t3.71\t1,383.5\n  Dòng tiền/Cổ phần TTM\t3.45\t-72.97\n       `;\n          const gptResponse = await gptAPICall(analysisQuestion);\n          const gptText = gptResponse.choices[0].message.content;\n\n          this.addTypingResponse(gptText, false);\n\n        } catch (error) {\n          console.error('Error:', error);\n          this.messages.push({ text: `Error fetching data for ${stockCode}.`, isUser: false, timestamp: new Date().toLocaleTimeString() });\n        }\n      } else {\n        setTimeout(\n          () => {\n            this.addTypingResponse('Tôi là FinBud, trợ lý AI trong lĩnh vực tài chính của bạn, phát triển bởi Bui Dinh Tri. Tôi được cấu hình đặc biệt trên nền tảng GPT-3.5 Turbo, với mục tiêu cung cấp thông tin sâu hơn và chuyên môn về tài chính và thị trường cổ phiếu.', false);\n          }, 300\n        )\n      }\n    },\n\n    addTypingResponse(text, isUser) {\n      const typingMessage = {\n        text: text,\n        isUser: isUser,\n        typing: true,\n        timestamp: new Date().toLocaleTimeString(),\n        username: isUser ? 'You' : 'FinBud Bot'\n      };\n\n      this.messages.push(typingMessage);\n      setTimeout(() => {\n        typingMessage.text = text;\n        typingMessage.typing = false;\n        this.$forceUpdate();\n      }, 2000);\n    },\n\n    extractStockCode(message) {\n      const pattern = /\\b[A-Z]{3,5}\\b/g;\n      const matches = message.match(pattern) || [];\n      return matches;\n    },\n\n    extractSharesAndCode(message) {\n      const stockCodePattern = /\\b[A-Z]{1,5}\\b/g;\n      const sharesPattern = /(\\b\\d{1,3}(,\\d{3})*\\b)(?=\\s*shares)/gi;\n\n      const stockCodes = message.match(stockCodePattern) || [];\n      const shares = message.match(sharesPattern) || [];\n\n      return { stockCodes, shares };\n    }\n  }\n}\n</script>\n\n\n<style scoped>\n.home-container {\n  display: flex;\n  height: 100vh;\n}\n\n.chat-container {\n  display: flex;\n  flex-direction: column;\n  flex: 1;\n}\n</style>\n"],"mappings":";;;EACOA,KAAK,EAAC;AAAgB;;EASpBA,KAAK,EAAC;AAAgB;;;;;;;uBAT7BC,mBAAA,CAyBM,OAzBNC,UAyBM,GAxBJC,YAAA,CAOEC,kBAAA;IANCC,OAAO,EAAEC,KAAA,CAAAD,OAAO;IAChBE,WAAU,EAAEC,QAAA,CAAAC,SAAS;IACrBC,YAAW,EAAEF,QAAA,CAAAG,UAAU;IACvBC,gBAAgB,EAAEJ,QAAA,CAAAK,cAAc;IAChCC,YAAW,EAAEN,QAAA,CAAAO,UAAU;IACvBC,cAAa,EAAER,QAAA,CAAAS;6HAElBC,mBAAA,CAeM,OAfNC,UAeM,GAdJhB,YAAA,CAA2CiB,qBAAA;IAA9BC,QAAQ,EAAEf,KAAA,CAAAgB,aAAa,CAACC;yCACrCpB,YAAA,CAWYqB,oBAAA;IAvBlBC,OAAA,EAAAC,QAAA,CAcU,MAAoC,E,kBADtCzB,mBAAA,CASE0B,SAAA,QAtBVC,WAAA,CAcqCtB,KAAA,CAAAuB,QAAQ,EAd7C,CAckBC,OAAO,EAAEC,KAAK;2BADxBC,YAAA,CASEC,2BAAA;QAPCC,GAAG,EAAEH,KAAK;QACV,SAAO,EAAED,OAAO,CAACK,MAAM;QACvBC,IAAI,EAAEN,OAAO,CAACM,IAAI;QAClBC,MAAM,EAAEP,OAAO,CAACO,MAAM;QACtBC,SAAS,EAAER,OAAO,CAACQ,SAAS;QAC5BC,QAAQ,EAAET,OAAO,CAACK,MAAM;QACxB,YAAU,EAAEL,OAAO,CAACK,MAAM,GAAG7B,KAAA,CAAAkC,UAAU,GAAGlC,KAAA,CAAAmC;;;IArBrDC,CAAA;MAwBMvC,YAAA,CAAuEwC,oBAAA;IAA3DC,aAAY,EAAEpC,QAAA,CAAAqC,WAAW;IAAGC,cAAa,EAAEtC,QAAA,CAAAuC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}